plane_data_external_schema = load ‘/user/trisha/project/airtraffic_control/plane_data_external’   USING  PigStorage(‘,’) AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:charrarray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
plane_data_external_schema = load ‘/user/trisha/project/airtraffic_control/plane_data_external’   USING  PigStorage(',') AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:charrarray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
plane_data_external_schema = load ‘/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv’  USING  PigStorage(‘,’) AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:charrarray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
plane_data_external_schema = load ‘/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv’  USING PigStorage(',') AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:charrarray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
plane_data_external_schema=load ‘/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv’ USING PigStorage(‘,’) AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:charrarray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
plane_data_external_schema = load ‘/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv’  USING  PigStorage(‘,’) AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:charrarray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
oad '/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv' USING PigStorage(',') AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:chararray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
load '/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv' USING PigStorage(',') AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:chararray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
plane_data_external_schema=load '/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv' USING PigStorage(',') AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:chararray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
plane_data_external_schema = load '/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv' USING PigStorage(',') AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:chararray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
dump plane_data_external_schema;
LOGS= LOAD 'log';
LOGS= LOAD 'plane_data_external_schema';
plane_data_external_schema_distinct = DISTINCT plane_data_external_schema;
dump plane_data_external_schema_distinct;
plane_data_external_schema_distinct_GROUP = GROUP plane_data_external_schema_distinct;
plane_data_external_schema_distinct_GROUP = GROUP plane_data_external_schema_distinct ALL;
plane_data_external_schema_distinct_COUNT = FOREACH plane_data_external_schema_distinct_GROUP GENERATE COUNT(plane_data_external_schema_distinct);
dump plane_data_external_schema_distinct_COUNT ;
plane_data_external_schema_distinct_NOTNULL = FILTER plane_data_external_schema_distinct BY ($2 is not null);
dump plane_data_external_schema_distinct_NOTNULL;
dump plane_data_external_schema_distinct_GROUP;
STORE plane_data_external_schema_distinct_NOTNULL into ‘/user/trisha/project/pig/plane_data_external_notnull_distinct’ USING PigStorage(‘,’);
STORE plane_data_external_schema_distinct_NOTNULL into '/user/trisha/project/pig/plane_data_external_notnull_distinct' USING PigStorage(',');
dump carriers_external;
Carriers_raw_schema = load '/user/trisha/project/airtraffic_control/carriers_external/carriers.csv' USING PigStorage(',') AS (Code:chararray,Description:chararray);
dump Carriers_raw_schema;
Carriers__raw_schema_CharReplace = FOREACH Carriers__raw_schema GENERATE REPLACE($1,'/',',');
Carriers_raw_schema_CharReplace = FOREACH Carriers_raw_schema GENERATE REPLACE($1,'/',',');
dump Carriers_raw_schema_CharReplace;
Carriers_raw_schema_CharReplace1 = FOREACH Carriers_raw_schema GENERATE REPLACE($1,’/‘,’-‘);
Carriers_raw_schema_charReplace1 = FOREACH Carriers_raw_schema GENERATE REPLACE($1,'/','-');
carrier_size_filter = FOREACH (FILTER Carriers_raw_schema BY SIZE($0) < 4) GENERATE Code,Description ;
carrier_size_filter = FOREACH (FILTER Carriers_raw_schema BY SIZE($0) <4) GENERATE Code,Description;
Carriers_raw_schema = load '/user/trisha/project/airtraffic_control/carriers_external/carriers.csv' USING PigStorage(',') AS (Code:chararray,Description:chararray);
carrier_size_filter = FOREACH (FILTER Carriers_raw_schema BY SIZE($0) <4) GENERATE Code,Description;
dump carrier_size_filter;
Carriers_raw_schema_CharReplace= FOREACH carrier_size_filter GENERATE $0,REPLACE($1,'/','-');
dump Carriers_raw_schema_CharReplace;
[1:12 AM, 1/20/2018] Miti Sollers: Airtraffic_control_all = load '/user/miti/project/airtraffic_control/airtraffic_control_allYears/airtraffic_control_allYears.csv' USING PigStorage(',') AS (Year:int,
Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,
FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,
Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray, CancellationCode:chararray,Diverted:int,CarrierDelay:int, 
WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Airtraffic_control_all = load '/user/miti/project/airtraffic_control/airtraffic_control_allYears/airtraffic_control_allYears.csv' USING PigStorage(',') AS (Year:int,
Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,
FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,
Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray, CancellationCode:chararray,Diverted:int,CarrierDelay:int, 
WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,
Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,
FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,
Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray, CancellationCode:chararray,Diverted:int,CarrierDelay:int, 
WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
dump Airtraffic_control_all;
Airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,
Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,
FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,
Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray, CancellationCode:chararray,Diverted:int,CarrierDelay:int, 
WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,
Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,
FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,
Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray, CancellationCode:chararray,Diverted:int,CarrierDelay:int, 
WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
dump Airtraffic_control_all;
Airtraffic_control_all =  load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,
Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,
FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,
Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray, CancellationCode:chararray,Diverted:int,CarrierDelay:int, 
WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Airtraffic_control_all =  load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,
exit;
Airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,
FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,
Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray, CancellationCode:chararray,Diverted:int,CarrierDelay:int, 
WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,
FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,
Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray, CancellationCode:chararray,Diverted:int,CarrierDelay:int, 
WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
dump Airtraffic_control_all;
Airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,
FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,
Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray, CancellationCode:chararray,Diverted:int,CarrierDelay:int, 
WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
airtraffic_control = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
dump airtraffic_control;
airtraffic_control = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Air_Field = FOREACH Airtraffic_control_all GENERATE Year,FlightNum,AirTime,TailNum;
Airtraffic_control_all= load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Air_Field = FOREACH Airtraffic_control_all GENERATE Year,FlightNum,AirTime,TailNum;
Airtraffic_control_all_group = GROUP Air_Field BY (FlightNum,Year,TailNum); 
TotalYear_Flight = FOREACH Airtraffic_control_all_group GENERATE group.Year AS Year,group.FlightNum AS FlightNum,group.TailNum AS tailnum,FLATTEN(SUM(Air_Field.AirTime)) AS TotalItem;
lim=LIMIT TotalYear_Flight 2;
lim = LIMIT TotalYear_Flight 2;
dump lim;
cancelled_flight = FOREACH(FILTER Airtraffic_control_all BY Cancelled == '1') GENERATE FlightNum,TailNum,UniqueCarrier,Cancelled ;
lim = LIMIT cancelled_flight 2;
dump lim;
cancelled_distinct = DISTINCT  cancelled_flight; 
lim_disinct = LIMIT cancelled_distinct 4;
dump lim_distinct;
dump lim_disinct;
STORE cancelled_distinct into ‘/user/trisha/project/pig/cancelled_distinct’ USING PigStorage(‘,’);
STORE cancelled_distinct into '/user/trisha/project/pig/cancelled_distinct' USING PigStorage(',');
dump cancelled_distinct;
airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
exit
exit;
airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
origin_dest = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)FlightNum, ' ', (chararray)DayofMonth,'-',(chararray)Month,'-',(chararray)Year, ' ',(chararray)DepTime, ' ',(chararray)ArrTime),Origin,Dest;
lim = LIMIT origin_dest 2;
dump lim;
STORE origin_dest
into ‘/user/trisha/project/pig/origin_dest’ USING PigStorage(‘,’);
STORE origin_dest into ‘/user/trisha/project/pig/origin_dest’ USING PigStorage(‘,’);
STORE origin_dest into ‘/user/trisha/project/pig/origin_dest’ USING PigStorage(',');
STORE origin_dest into '/user/trisha/project/pig/origin_dest' USING PigStorage(',');
airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
origin_dest = FOREACH airtraffic_control_all GENERATE CONCAT((char array)TailNum,(chararray)FlightNum, ' ', (chararray)DayofMonth,'-',(chararray)Month,'-',(chararray)Year, ' ',(chararray)DepTime, ' ',(chararray)ArrTime),Origin,Dest;
origin_dest = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)FlightNum, ' ', (chararray)DayofMonth,'-',(chararray)Month,'-',(chararray)Year, ' ',(chararray)DepTime, ' ',(chararray)ArrTime),TailNum,Origin,Dest;
origin_dest_distinct = DISTINCT origin_dest;
lim = LIMIT origin_dest_distinct 2;
dump lim;
origin_destination = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)DayofMonth,'-',(chararray)Month,'-',(chararray)Year, ' ')TailNum,Origin,Dest;
origin_destination = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)DayofMonth,'-',(chararray)Month,'-',(chararray)Year, ' '),TailNum,Origin,Dest;
origin_dest_distinct = DISTINCT origin_destination;
STORE origin_dest_distinct into ‘/user/trisha/project/pig/origin_dest_distinct’ USING PigStorage(‘,’);
STORE origin_dest_distinct into '/user/trisha/project/pig/origin_dest_distinct' USING PigStorage(',');
origin_destination1 = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)DayofMonth,'-',(chararray)Month,'-',(chararray)Year, ' ‘),FightNum,TailNum,Origin,Dest;
origin_destination1 = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)DayofMonth,'-',(chararray)Month,'-',(chararray)Year,' ‘),FightNum,TailNum,Origin,Dest;
origin_destination1 = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)DayofMonth,'-',(chararray)Month,'-',(chararray)Year),FightNum,TailNum,Origin,Dest;
origin_destination_first_last = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)DayofMonth,'-',(chararray)Month,'-',(chararray)Year),FlightNum,TailNum,Origin,Dest;
origin_dest_distinct = DISTINCT origin_destination_first_last;
lim = LIMIT origin_dest_distinct 2;
STORE origin_dest_distinct into ‘/user/trisha/project/pig/pig/origin_dest_distinct’ USING PigStorage(‘,’);
STORE origin_dest_distinct into ‘/user/trisha/project/pig/pig/origin_destination_first_last’ USING PigStorage(‘,’);
STORE origin_dest_distinct into '/user/trisha/project/pig/pig/origin_destination_first_last' USING PigStorage(',');
plane_data_external_schema_distinct = DISTINCT plane_data_external_schema; 
plane_data_external_schema = load '/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv' USING PigStorage(',') AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:chararray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
plane_data_external_schema_1 = load '/user/trisha/project/airtraffic_control/plane_data_external/plane-data.csv' USING PigStorage(',') AS (tailnum:chararray,type:chararray,manufacturer:chararray,issue_date:chararray,model:chararray,status:chararray,aircraft_type:chararray,engine_type:chararray,year:int);
plane_data_external_schema_distinct = DISTINCT plane_data_external_schema_1; 
plane_data_external_schema_distinct_GROUP = GROUP plane_data_external_schema_distinct ALL;
plane_data_external_schema_distinct_COUNT = FOREACH plane_data_external_schema_distinct_GROUP GENERATE COUNT(plane_data_external_schema_distinct);
plane_data_external_schema_distinct_NOTNULL = FILTER plane_data_external_schema_distinct BY ($2 is not null); 
lim = LIMIT plane_data_external_schema_distinct_NOTNULL 2;
dump lim;
STORE plane_data_external_schema_distinct_NOTNULL into '/user/trisha/project/pig/plane_data_external_notnull_distinct' USING PigStorage(',');
STORE plane_data_external_schema_distinct_NOTNULL into '/user/trisha/project/pig/plane_data_external_notnull_distinct1' USING PigStorage(',');
origin_destination_firstandlast = FOREACH airtraffic_control_all GENERATE CONCAT(chararray)Year,(chararray)Month,'-',(chararray)DayofMonth,'-'),FlightNum,TailNum,Origin,Dest;
origin_destination_firstandlast = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,(chararray)Month,'-',(chararray)DayofMonth,'-'),FlightNum,TailNum,Origin,Dest;
origin_destination_first_and_last = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,(chararray)Month,'-',(chararray)DayofMonth,'-'),FlightNum,TailNum,Origin,Dest;
origin_dest_distinct = DISTINCT origin_destination_first_and_last;
STORE origin_dest_distinct into '/user/trisha/project/pig/origin_destination_first_and_last' USING PigStorage(',');
STORE origin_dest_distinct into '/user/trisha/project/pig/origin_destination_firstandlast' USING PigStorage(',');
airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
origin_destination_first_and_last = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,(chararray)Month,'-',(chararray)DayofMonth,),FlightNum,TailNum,Origin,Dest;
origin_destination_first_and_last = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,(chararray)Month,'-',(chararray)DayofMonth),FlightNum,TailNum,Origin,Dest;
origin_dest_distinct = DISTINCT origin_destination_first_and_last;
STORE origin_dest_distinct into '/user/trisha/project/pig/origin_destination_first_and_last' USING PigStorage(',');
airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
origin_destination_first_and_last = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,(chararray)Month,'-',(chararray)DayofMonth),FlightNum,TailNum,Origin,Dest;
origin_dest_distinct = DISTINCT origin_destination_first_and_last;
lim = LIMIT origin_dest_distinct 2;
dump lim;
STORE origin_dest_distinct into ‘/user/trisha/project/pig/origin_destination_first_and_last’ USING PigStorage(‘,’);
STORE origin_dest_distinct into '/user/trisha/project/pig/origin_destination_first_and_last' USING PigStorage(',');
airtraffic_control_all = load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
origin_destination_first_and_last = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,’-‘,(chararray)Month,'-',(chararray)DayofMonth),FlightNum,TailNum,Origin,Dest;
origin_destination1= FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,’-‘,(chararray)Month,'-',(chararray)DayofMonth),FlightNum,TailNum,Origin,Dest;
origin_destination1= FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,'-',(chararray)Month,'-',(chararray)DayofMonth),FlightNum,TailNum,Origin,Dest;
origin_dest_distinct = DISTINCT origin_destination1;
STORE origin_dest_distinct into ‘/user/trisha/project/pig/origin_destination_first_and_last’ USING PigStorage(‘,’);
STORE origin_dest_distinct into '/user/trisha/project/pig/origin_destination_first_and_last' USING PigStorage(',');
lim = LIMIT origin_dest_distinct 2;
origin_dest_distinct2 = DISTINCT origin_destination1;
lim = LIMIT origin_dest_distinct2 2;
dump lim;
STORE origin_dest_distinct2 into ‘/user/trisha/project/pig/origin_destination_first_and_last’ USING PigStorage(‘,’);
STORE origin_dest_distinct2 into '/user/trisha/project/pig/origin_destination_first_and_last' USING PigStorage(',');
origin_destination_flight= FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,’-‘,(chararray)Month,'-',(chararray)DayofMonth),FlightNum,TailNum,Origin,Dest;
origin_destination_flight = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,'-',chararray)Month,'-',(chararray)DayofMonth),FlightNum,TailNum,Origin,Dest;
origin_destination_flight = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,'-',(chararray)Month,'-',(chararray)DayofMonth),FlightNum,TailNum,Origin,Dest;
origin_destination_flight1 = FOREACH airtraffic_control_all GENERATE CONCAT((chararray)Year,'-',(chararray)Month,'-',(chararray)DayofMonth),FlightNum,TailNum,Origin,Dest;
origin_dest_distinct2 = DISTINCT origin_destination_flight1;
lim = LIMIT origin_dest_distinct2 2;
dump lim;
STORE origin_dest_distinct2 into ‘/user/trisha/project/pig/origin_destination_flight’ USING PigStorage(‘,’);
STORE origin_dest_distinct2 into '/user/trisha/project/pig/origin_destination_flight' USING PigStorage(',');
dump lim;
Carriers_raw_schema = load '/user/trisha/project/airtraffic_control/carriers_external/carriers.csv' USING PigStorage(',') AS (Code:chararray,Description:chararray);
carrier_size_filter = FOREACH (FILTER Carriers_raw_schema BY SIZE($0) <4) GENERATE Code,Description;
Carriers_raw_schema_CharReplace= FOREACH carrier_size_filter GENERATE $0,REPLACE($1,'/','-');
STORE Carriers_raw_schema_CharReplace into /'user/trisha/project/pig/carriers_raw_schema' USING PigStorage(',');
STORE Carriers_raw_schema_CharReplace into '/user/trisha/project/pig/carriers_raw_schema' USING PigStorage(',');
Carriers_raw_schema_CharReplace= FOREACH carrier_size_filter GENERATE $0,REPLACE($1,'/','-');
Carriers_raw_schema_CharReplace1= FOREACH carrier_size_filter GENERATE $0,REPLACE($1,'/','-');
 Carriers_raw_schema_charReplace = FOREACH Carriers_raw_schema GENERATE REPLACE($1,'/','-');
STORE Carriers_raw_schema_charReplace into '/user/trisha/project/pig/carriers_charreplace' USING PigStorage(',');
Airtraffic_control_all= load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Airtraffic_controlall= load '/user/trisha/project/airtraffic_control/airtraffic_control_allyear.csv' USING PigStorage(',') AS (Year:int,Month:int,DayofMonth:int,DayOfWeek:int,DepTime:int,CRSDepTime:int,ArrTime:int,CRSArrTime:int,UniqueCarrier:chararray,FlightNum:int,TailNum:chararray,ActualElapsedTime:int,CRSElapsedTime:int,AirTime:int,ArrDelay:int,DepDelay:int,Origin:chararray,Dest:chararray,Distance:chararray,TaxiIn:int,TaxiOut:int,Cancelled:chararray,CancellationCode:chararray,Diverted:int,CarrierDelay:int,WeatherDelay:int,NASDelay:int,SecurityDelay:int,LateAircraftDelay:int);
Air_Field = FOREACH Airtraffic_controlall GENERATE Year,FlightNum,AirTime,TailNum;
Airtraffic_control_all_group = GROUP Air_Field BY (FlightNum,Year,TailNum); 
TotalYear_Flight = FOREACH Airtraffic_control_all_group GENERATE group.Year AS Year,group.FlightNum AS FlightNum,group.TailNum AS tailnum,FLATTEN(SUM(Air_Field.AirTime)) AS TotalItem;
STORE TotalYear_Flight into '/user/trisha/project/pig/totalyear_flight' USING PigStorage(',');
starrating = load 'user.json' as (A);
lim = LIMIT starrating 2;
dump lim;
user_json = load ‘/user/trisha/project2/user_json/user.json/ USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int');
user_json = load ‘/user/trisha/project2/user_json/user.json/‘ USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int');
user_json = LOAD ‘/user/trisha/project2/user_json/user.json/‘ USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int');
user_json = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int');
lim = LIMIT user_json 2;
dump lim;
star_group = group user_json all;
star_group = group average_stars all;
grouped = group review_count by average_stars; 
grouped = group user_json by average_stars;
lim = LIMIT grouped 2;
dump lim;
avgreviews = FOREACH grouped group and avg(review_count.average_stars);
avgreviews = FOREACH grouped GENERATE name and avg(review_count.average_stars);
avgreviews = FOREACH grouped GENERATE name,avg(review_count.average_stars);
avgreviews = FOREACH grouped GENERATE name,AVG(review_count.average_stars);
avgreviews = FOREACH grouped GENERATE grouped, avg(review_count);
avgreviews = FOREACH grouped GENERATE grouped, avg(review_count.average_stars);
avgreviews = FOREACH grouped GENERATE group as Rating, avg(review_count.average_stars) as avg_r;
avgreviews = FOREACH grouped GENERATE group as Rating,AVG(review_count.average_stars) as avg_r;
avgreviews = FOREACH grouped GENERATE group as Rating,AVG(review_count) as avg_r;
avgreviews = FOREACH grouped GENERATE group as Rating,AVG(review_count.average_stars) as avg_r;
avgreviews = FOREACH grouped GENERATE group as Rating,AVG(user_json.review_count) as avg_r;
lim = LIMIT avgreviews 2;
dump lim;
lim1 = LIMIT grouped 5;
dump lim1;
avgreviews = FOREACH grouped GENERATE group as Rating,AVG(user_json.review_count) as avg_r;
lim = LIMIT avgreviews 5;
dump lim;
user_json_group = GROUP reviews_count_user_json BY name;
user_json_group = GROUP user_json BY name;
result = FOREACH user_json_group GENERATE SUM(user_json.review_count);
lim = LIMIT result 2;
dump lim;
STORE result into '/user/trisha/project2/totalreview1/' USING JsonStorage();
dump lim;
STORE result into '/user/trisha/project2/totalreview1/' USING JsonStorage();
STORE result into '/user/trisha/project2/totalreview1/' USING PigStorage();
result_totalreview = FOREACH user_json_group GENERATE SUM(user_json.review_count),name;
result_totalreview = FOREACH user_json_group GENERATE name,SUM(user_json.review_count);
result_totalreview = FOREACH user_json_group GENERATE user_json.name,SUM(user_json.review_count);
STORE result_totalreview into '/user/trisha/project2/result_totalreview1' Using PigStorage(',');
result_totalreview1 = FOREACH user_json_group GENERATE user_json.name,FLATTEN(SUM(user_json.review_count));
 user_json_group = GROUP user_json BY name;
 user_json_group1 = GROUP user_json BY name;
user_json = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
user_json_group = GROUP user_json BY name;
result1 = FOREACH user_json_group GENERATE user_json.name, FLATTEN(SUM(reviews_count_user_json.review_count));
result1 = FOREACH user_json_group GENERATE user_json.name,FLATTEN(SUM(reviews_count_user_json.review_count));
result1 = FOREACH user_json_group GENERATE user_json.name,FLATTEN(SUM(user_json.review_count));
lim = LIMIT result1 2;
dump lim;
result2 = FOREACH user_json_group GENERATE user_json_group,FLATTEN(SUM(user_json.review_count));
user_json = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
user_name = FOREACH user_json GENERATE name;
 user_json_group = GROUP user_json BY name;
 user_json_group = GROUP user_name BY name;
 user_json_group1 = GROUP user_name BY name;
user_json_group = GROUP user_name BY name;
result = FOREACH user_json_group GENERATE user_json.name, FLATTEN(SUM(user_json.review_count));
result = FOREACH user_json_group GENERATE user_name.name,FLATTEN(SUM(user_json.review_count));
result = FOREACH user_json_group GENERATE group.name,FLATTEN(SUM(user_json.review_count));
result = FOREACH user_json_group GENERATE user_json_group,FLATTEN(SUM(user_json.review_count));
user_fields = FOREACH user_json GENERATE user_id,name,review_count;
user_group = GROUP user_fields BY (user_id,name);
result = FOREACH user_group GENERATE user_group.name,user_group.user_id,FLATTEN(SUM(user_fields.review_count));
result = FOREACH user_group GENERATE user_group.name,group.user_id,FLATTEN(SUM(user_fields.review_count));
result = FOREACH user_group GENERATE group.name,group.user_id,FLATTEN(SUM(user_fields.review_count));
lim = LIMIT result 2;
dump lim;
STORE result into '/user/trisha/project2/result_1/' USING PigStorage(',');
user_json = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
user_json_review = FOREACH user_json GENERATE review_count;
user_json_group = GROUP user_json_review BY review_count;
result = FOREACH user_json_group GENERATE SUM(user_json_group.review_count);
result = FOREACH user_json_group GENERATE SUM(user_json.review_count);
lim = LIMIT user_json 2;
dump lim;
result = FOREACH user_json_group GENERATE SUM(user_json.review_count);
result = FOREACH user_json_group GENERATE FLATTEN(SUM(user_json.review_count));
user_json = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
user_json = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int');
lim = LIMIT user_json 1;
user_json1 = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
user_json1 = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int');
quit
user_json1 = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int');
business_json = LOAD '/user/trisha/project_2/business_json/business.json' USING JsonLoader('business_id:chararray,name:chararray,neighborhood:chararray,address:chararray,city:chararray,state:chararray,postal_code:chararray,latitude:double,longitude:double,stars:double,review_count:int,is_open:int,attributes:chararray,categories:bag{(chararray)},hours:bag{(chararray,chararray)}');
lim = LIMIT business_json 4;
dump lim;
business_json = LOAD '/user/trisha/project2/business/business.json' USING JsonLoader('business_id:chararray,name:chararray,neighborhood:chararray,address:chararray,city:chararray,state:chararray,postal_code:chararray,latitude:double,longitude:double,stars:double,review_count:int,is_open:int,attributes:chararray,categories:bag{(chararray)},hours:bag{(chararray,chararray)}');
lim1 = LIMIT business_json 4;
dump lim1;
GROUP_business_json = GROUP business_json BY (city,state);
statecity_totalreview = FOREACH GROUP_business_json group.city AS city,group.state AS state, FLATTEN(SUM(business_json.review_count)) AS total;
total_review = FOREACH GROUP_business_json group.city AS city,group.state AS state,FLATTEN(SUM(business_json.review_count)) AS total;
total_review = FOREACH GROUP_business_json group.city,group.state,FLATTEN(SUM(business_json.review_count)) AS total;
total_review = FOREACH GROUP_business_json GENERATE group.city,group.state,FLATTEN(SUM(business_json.review_count)) AS total;
dist_total_review = DISTINCT total_review;
lim = LIMIT dist_total_review 3;
dump lim;
lim1 = LIMIT dist_total_review 10;
dump lim1;
STORE dist_total_review into '/user/trisha/project2/result_2' USING PigStorage(',');
user_json = LOAD '/user/trisha/project2/user_json/user.json/user.json’ USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
user_json2 = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
business_json = LOAD '/user/trisha/project2/business/business.json' USING JsonLoader('business_id:chararray,name:chararray,neighborhood:chararray,address:chararray,city:chararray,state:chararray,postal_code:chararray,latitude:double,longitude:double,stars:double,review_count:int,is_open:int,attributes:chararray,categories:bag{(chararray)},hours:bag{(chararray,chararray)}');
GROUP_business_json = GROUP business_json BY (name,city,state);
totalreview = FOREACH GROUP_business_json GENERATE group.name as name1,group.city AS city1,group.state AS state1, FLATTEN(SUM(business_json.review_count)) AS total;
lim = LIMIT totalreview 2; 
dump lim;
dist_totalreview = DISTINCT totalreview ;
totalreview_above_1000 = FILTER dist_totalreview BY total> 1000;
lim1 = LIMIT totalreview_above_1000 3;
dump lim1;
STORE totalreview_above_1000 into '/user/trisha/project2/result_3' USING PigStorage(',');
user_json = LOAD '/user/trisha/project2/user_json/user.json/user.json’ USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
user_json_ = LOAD '/user/trisha/project2/user_json/user.json/user.json’ USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
user_json_ = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
user_json2 = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
grouped = group user_json2 by (name,average_stars);
avgreviews = FOREACH grouped GENERATE group.name as Name,AVG(user_json2.review_count) as avg_r;
lim = LIMIT avgreviews 5;
dump lim;
distinct_avg = DISTINCT avgreviews;
lim1 = LIMIT distinct_avg 5;
dump lim1;
grouped1 = group user_json2 by average_stars;
avgreviews = FOREACH grouped1 GENERATE group as Rating,AVG(user_json.review_count) as avg_r;
avgreviews = FOREACH grouped1 GENERATE group as Rating,AVG(user_json2.review_count) as avg_r;
dis_avg = DISTINCT avgreviews;
lim = LIMIT avgreviews 5;
dump lim;
grouped2 = group user_json2 by (user_id,average_stars);
avgreviews = FOREACH grouped2 GENERATE group.user_id as id,group.average_stars as Rating,AVG(user_json.review_count) as avg_r;
avgreviews = FOREACH grouped2 GENERATE group.user_id as id,group.average_stars as Rating,AVG(user_json2.review_count) as avg_r;
dis = DISTINCT avgreviews;
lim2 = LIMIT dis 5;
dump lim2;
grouped2 = group user_json2 by average_stars;
avgreviews = FOREACH grouped2 GENERATE group.stars as Rating,AVG(user_json.review_count) as avg_review;
avgreviews = FOREACH grouped2 GENERATE group.stars as Rating,AVG(user_json2.review_count) as avg_review;
avgreviews = FOREACH grouped2 GENERATE group.average_stars as Rating,AVG(user_json2.review_count) as avg_review;
avgreviews = FOREACH grouped2 GENERATE group as Rating,AVG(user_json2.review_count) as avg_review;
dis_avg1 = DISTINCT avgreviews;
lim = LIMIT dis_avg1 5;
dump lim;
STORE dis_avg1 into '/user/trisha/project2/result_4' USING PigStorage(',');
lim = LIMIT business_json 3;
lim11 = LIMIT business_json 3;
dump lim11;
business_json = LOAD '/user/trisha/project2/business/business.json' USING JsonLoader('business_id:chararray,name:chararray,neighborhood:chararray,address:chararray,city:chararray,state:chararray,postal_code:chararray,latitude:double,longitude:double,stars:double,review_count:int,is_open:int,attributes:chararray,categories:bag{(chararray)},hours:bag{(chararray,chararray)}');
business_json1 = LOAD '/user/trisha/project2/business/business.json' USING JsonLoader('business_id:chararray,name:chararray,neighborhood:chararray,address:chararray,city:chararray,state:chararray,postal_code:chararray,latitude:double,longitude:double,stars:double,review_count:int,is_open:int,attributes:chararray,categories:bag{(chararray)},hours:bag{(chararray,chararray)}');
quit
business_json1 = LOAD '/user/trisha/project2/business/business.json' USING JsonLoader('business_id:chararray,name:chararray,neighborhood:chararray,address:chararray,city:chararray,state:chararray,postal_code:chararray,latitude:double,longitude:double,stars:double,review_count:int,is_open:int,attributes:chararray,categories:bag{(chararray)},hours:bag{(chararray,chararray)}');
grouped = GROUP business_json1 BY(state);
top = FOREACH grouped GENERATE FLATTEN(MAX(business_json1.review_count)) LIMIT 10;
top = FOREACH grouped GENERATE FLATTEN(MAX(business_json1.review_count));
lim = LIMIT top 5;
dump lim;
top1 = FOREACH grouped GENERATE grouped.state FLATTEN(MAX(business_json1.review_count));
top1 = FOREACH grouped GENERATE grouped.state,FLATTEN(MAX(business_json1.review_count));
top1 = FOREACH grouped GENERATE group as state,FLATTEN(MAX(business_json1.review_count));
lim = LIMIT top1 5;
dump lim;
top1 = FOREACH grouped GENERATE grouped as state,FLATTEN(MAX(business_json1.review_count));
top2 = FOREACH grouped GENERATE group as state,MAX(business_json1.review_count);
lim = LIMIT top2 5;
dump lim;
lim2 = LIMIT grouped 10;
dump lim2;
grouped1 = GROUP business_json BY(state);
grouped1 = GROUP business_json2 BY(state);
grouped1 = GROUP business_json1 BY(state);
lim12 = LIMIT grouped1 5;
dump lim12;
grouped1 = GROUP business_json1 BY(business_json1.state);
lim11 = LIMIT grouped1 5;
dump lim11;
describe business_json1;
group = GROUP business_json1 by (state,review_count);
group1 = GROUP business_json1 by (state,review_count);
lim22 = LIMIT group1 5;
dump lim22;
group1 = GROUP business_json1 BY (state,review_count);
lim12 = LIMIT group1 5;
dump lim12;
user_json = LOAD '/user/trisha/project2/user_json/user.json' USING JsonLoader('user_id:chararray,name:chararray,review_count:int,yelping_since:chararray,friends:bag{(chararray)},useful:int,funny:int,cool:int,fans:int,elite:bag{(int)},average_stars:double,compliment_hot:int,compliment_more:int,compliment_profile:int,compliment_cute:int,compliment_list:int,compliment_note:int,compliment_plain:int,compliment_cool:int,compliment_funny:int,compliment_writer:int,compliment_photos:int'); 
groupuser = GROUP user_json BY name;
lim123 = LIMIT groupuser BY 5;
lim123 = LIMIT groupuser 5;
dump lim123;
business_json = LOAD '/user/trisha/project2/business/business.json' USING JsonLoader('business_id:chararray,name:chararray,neighborhood:chararray,address:chararray,city:chararray,state:chararray,postal_code:chararray,latitude:double,longitude:double,stars:double,review_count:int,is_open:int,attributes:chararray,categories:bag{(chararray)},hours:bag{(chararray,chararray)}');
grouped = GROUP business_json BY state;
flatten = FLATTEN(grouped);
flatten = FOREACH grouped GENERATE FLATTEN(grouped);
flatten = FOREACH grouped GENERATE FLATTEN(business_json.state);
flatten = FOREACH grouped.state GENERATE FLATTEN(business_json.state);
flatten = FOREACH grouped GENERATE FLATTEN(grouped);
state = FOREACH business_json.state GENERATE FLATTEN(business_json.state);
state = FOREACH business_json.state GENERATE FLATTEN(state);
state = FOREACH state GENERATE FLATTEN(business_json.state);
group = GENERATE business_json.state;
state = FOREACH business_json GENERATE state;
lim = LIMIT state 5;
dump lim;
state1 = FOREACH business_json GENERATE (state,review_count);
lim1 = LIMIT state1 5;
dump lim1;
distinct = DISTINCT state1;
dis = DISTINCT state1;
limi = LIMIT dis 10;
dump limi;
state_review = FOREACH business_json GENERATE (state,review_count);
limit = LIMIT state_review 5;
limit1 = LIMIT state_review 5;
dump limit1;
x = FOREACH state_review GENERATE MAX(review_count);
x = FOREACH state_review GENERATE MAX(state_review.review_count);
x = FOREACH state_review GENERATE MAX(business_json.review_count);
x = FOREACH state_review GENERATE state, MAX(business_json.review_count);
x = FOREACH state_review GENERATE  MAX(business_json.review_count);
register math.jar;
dump lim1;
Groupstate = GROUP business_json BY (business_id,state);
state_review = FOREACH Groupstate GENERATE (business_id,state,review_count);
state_review = FOREACH Groupstate GENERATE group.business_id,group.state,group.review_count;
Groupstate1 = GROUP business_json BY (business_id,state,review_count);
state_review = FOREACH Groupstate GENERATE group.business_id,group.state,group.review_count;
state_review = FOREACH Groupstate1 GENERATE group.business_id,group.state,group.review_count;
lim1 = LIMIT state_review 5;
dump lim1;
dist = DISTINCT Groupstate1;
result = FOREACH dist GENERATE group,MAX(business_json.review_count);
limresult = LIMIT result 5;
dump limresult;
Groupstate1 = GROUP business_json BY (business_id,state,review_count);
distgroup = DISTINCT Groupstate1;
limgroup = LIMIT distgroup 5;
dump limgroup;
group1 = GROUP business_json BY (business_id,state);
dist = DISTINCT group1;
lim11 = LIMIT dist 5;
dump lim11;
group1 = GROUP business_json BY state;
dist1 = DISTINCT group1;
lim = LIMIT dist1;
lim = LIMIT dist1 5;
dump lim;
statereview = FOREACH dist1 GENERATE group.state,business_id,MAX(business_json.review_count);
statereview = FOREACH dist1 GENERATE group1.state,business_id,MAX(business_json.review_count);
statereview = FOREACH dist1 GENERATE dist1,business_id,MAX(business_json.review_count);
statereview = FOREACH dist1 GENERATE group1.state,business_id,MAX(business_json.review_count);
statereview = FOREACH dist1 GENERATE state,business_id,MAX(business_json.review_count);
group1 = GROUP business_json BY state GENERATE business_id;
group1 = GROUP business_json BY state GENERATE state, business_id;
group1 = GROUP business_json BY state GENERATE state,business_id;
business_json = LOAD '/user/trisha/project2/business/business.json' USING JsonLoader('business_id:chararray,name:chararray,neighborhood:chararray,address:chararray,city:chararray,state:chararray,postal_code:chararray,latitude:double,longitude:double,stars:double,review_count:int,is_open:int,attributes:chararray,categories:bag{(chararray)},hours:bag{(chararray,chararray)}');
ranking = rank business_json BY state  DENSE;
lim = LIMIT ranking 5;
dump lim;
grouped = GROUP business_json BY state;
business_json = LOAD '/user/trisha/project2/business/business.json' USING JsonLoader('business_id:chararray,name:chararray,neighborhood:chararray,address:chararray,city:chararray,state:chararray,postal_code:chararray,latitude:double,longitude:double,stars:double,review_count:int,is_open:int,attributes:chararray,categories:bag{(chararray)},hours:bag{(chararray,chararray)}');
grouped = GROUP business_json BY state;
result = FOREACH grouped GENERATE group,MAX(business_json.review_count);
lim = LIMIT result 5;
dump lim;
lim = LIMIT result 10;
dump lim;
top = FOREACH grouped order business_json by review_count desc;
top = FOREACH grouped ORDER business_json BY review_count desc;
top = FOREACH grouped GENERATE ORDER business_json BY review_count desc;
top = ORDER business_json BY review_count desc;
lim = LIMIT top 5;
dump lim;
grouped = GROUP top BY (state,review_count);
result = FOREACH grouped GENERATE group,MAX(top.review_count);
lim = LIMIT result 5;
dump lim;
result = FOREACH grouped GENERATE group,MAX(top.review_count);
dump lim;
top1 = ORDER business_json BY review_count desc;
lim1 = LIMIT top1 5;
dump lim1;
